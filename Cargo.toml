[workspace]
members = ["zako_core", "zako_cli"]
default-members = ["zako_core", "zako_cli"]
resolver = "3"

[workspace.lints.clippy]
unwrap_used = "deny"
expect_used = "deny"
panic = "deny"

[workspace.lints.rustdoc]
missing_docs = "warn"

[workspace.dependencies]
clap = { version = "4.5", default-features = true, features = [
    "derive",
    # 若不是从天上赐的，clap就不能得什么:
    # "cargo",
    # "env",
    "unicode",
    "wrap_help",
] }
semver = { version = "1.0", features = ["serde"] }
unicode-ident = "1.0.22"
thiserror = "2"
cfg-if = "1.0.4"
num_cpus = "1.17.0"
tracing = "0.1.41"
tracing-core = "0.1.34"
tracing-subscriber = "0.3.20"
serde = "1.0"
const_format = "0.2.35"
serde_json = "1.0"
ahash = "0.8.12"
argfile = "0.2"
lenient_semver = "0.4.2"

zip = "6.0.0"

humantime = "2.3.0"

tracing-error = "0.2.1"

opentelemetry = "0.31.0"
opentelemetry_sdk = "0.31.0"
opentelemetry-stdout = "0.31.0"
tracing-opentelemetry = "0.32.0"

static_init = "1.0.4"

convert_case = "0.9.0"

tokio = { version = "1.48.0", features = ["full"] }

tracing-attributes = "0.1.24"

ts-rs = { version = "11.1.0", features = ["format", "serde-compat"] }

glob = "0.3.3"
strum = { version = "0.27", features = ["derive"] }

colorchoice-clap = "1.0.7"

eyre = "0.6"
color-eyre = "0.6"
colorchoice = "1.0.4"

zstd = "0.13.3"

url = "2.5.7"

futures = "0.3.31"
futures-util = "0.3.31"

v8 = "142.1.0"
serde_v8 = "=0.278.0"

smallvec = "1.15.1"

oxc_transformer = "0.102.0"
oxc_allocator = "0.102.0"
oxc_codegen = "0.102.0"
oxc_parser = "0.102.0"
oxc_semantic = "0.102.0"
oxc_span = "0.102.0"

exit-code = "1.0"

bytes = "1.11.0"

async-stream = "0.3.6"

xxhash-rust = "0.8.15"

deno_core = "0.372.0"
deno_error = "0.7.1"

parking_lot = "0.12.5"

dunce = "1.0.5"

sha2 = "0.10.9"

hex = "0.4.3"

async-trait = "0.1.89"

shadow-rs = "1.4"
clap_complete = "4.5.61"

reqwest = { version = "0.12.0", features = [
    "json",
    "blocking",
    "json",
    "gzip",
    "brotli",
    "zstd",
    "deflate",
    "stream",
    "socks",
    "default-tls",
    "native-tls",
] }
indicatif = "0.18.3"

prost = "0.14"
prost-types = "0.14"
tonic-prost-build = "0.14.2"
tonic = "0.14.2"
tonic-prost = "0.14.2"

tokio-stream = "0.1"

dashmap = { version = "6.1.0" }

uuid = { version = "1.18.1", features = ["v4"] }

tokio-util = "0.7.17"

tracing-tree = "0.4.1"

dirs = "6.0.0"

[profile.dev]
opt-level = 1
debug = true
split-debuginfo = "unpacked"
lto = false
panic = "unwind"
strip = "none"
incremental = true

[profile.dev.package."*"]
opt-level = 3

[profile.test]
inherits = "dev"

[profile.release]
opt-level = 3
lto = "fat"
codegen-units = 1
panic = "unwind"
strip = "symbols"
debug = false

[profile.bench]
inherits = "release"

[workspace.package]
version = "0.1.0"
authors = ["MoeGodot <me@kawayi.moe>"]
description = "The post-modern building tool that your mom warned you about."
documentation = "https://github.com/moefra/zako"
repository = "https://github.com/moefra/zako"
homepage = "https://github.com/moefra/zako"
edition = "2024"
license = "GPL-3.0-or-later"
