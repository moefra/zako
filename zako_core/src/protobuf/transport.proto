syntax = "proto3";

package zako.v1.transport;

import "digest.proto";
import "range.proto";

message BlobResource{
    zako.v1.digest.Digest digest = 1;

    zako.v1.range.BlobRange range = 2;
}

message DownloadRequest {
    BlobResource metadata = 1;
}

  message DownloadResponse {
    bytes data = 1;
  }

  message UploadRequest {
    oneof payload {
      BlobResource metadata = 1;
      bytes chunk = 2;
    }
  }

message UploadResponse {
    uint64 committed_size = 1;
}

service Transport {
  rpc Download(DownloadRequest) returns (stream DownloadResponse);

  rpc Upload(stream UploadRequest) returns (UploadResponse);
}
